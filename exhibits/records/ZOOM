ZOOM
      SUBROUTINE ZOOM(JN) 
C 
C  ADJUST DISPLAY ROOT IN A RETURNABLE FASHION. 
C  JN IS TO BECOME THE ROOT.  IF ZERO, THE PREVIOUS 
C  ROOT IS TO BE RESTORED.
C  IF NEGATIVE, ROOTS WILL BE RESTORED UNTIL THE
C  BEGINNING OF PROGRAM IS LOCATED. 
C 
*CALL,DATA
*CALL,FILE
      INTEGER LCALL(5)
      DATA LCALL/1HC,1HA,1HL,1HL,1H / 
C 
C  PUSH CURRENT ROOT ON STACK 
C 
      IF(JN.LE.0) GOTO 202
      IF(JN.EQ.IRD) GOTO 302
      CALL PUSH(IRD)
      CALL PUSH(1)
      IRD=JN
      GOTO 902
C 
C  POP OLD ROOT FROM STACK
C 
202   CALL PULL (IT)
      IF(IT.EQ.1) GOTO 204
      IF(IT.EQ.2) GOTO 402
      CALL PUSH(IT) 
      RETURN
204   CALL PULL(IRD)
      IF(JN.EQ.0) GOTO 902
      CALL PULL(IT) 
      IF(IT.EQ.1) GOTO 204
      CALL PUSH(IT) 
      GOTO 902
C 
C  PUSH FILE NAME ON STACK AND OPEN NEW ONE 
C 
302   IF(LTY(IRD).NE.1) RETURN
      DO 304 I1=1,5 
      IF(LTX(I1,IRD).NE.LCALL(I1)) RETURN 
304   CONTINUE
      CALL PUSH(IRD)
      DO 305 I1=1,NFN 
305   CALL PUSH(LFN(NFN-I1+1))
      CALL PUSH(NFN)
      CALL PUSH(2)
      DO 306 I1=6,11
      NC=LTX(I1,IRD)
      IF(NC.EQ.1H ) GOTO 308
      IF(NC.EQ.1H() GOTO 308
      NFN=I1-5
306   LFN(NFN)=NC 
308   CALL DUMPER 
      CALL FRETRE(IRT)
      CALL FRETRE(IKP)
      CALL RENAME(LFN,NFN)
      CALL LOADER 
      GOTO 902
C 
C  SAVE FILE AND POP BACK TO OLD ONE
C 
402   CALL DUMPER 
      CALL FRETRE(IRT)
      CALL FRETRE(IKP)
      CALL PULL(NFN)
      DO 404 I1=1,NFN 
404   CALL PULL(LFN(I1))
      CALL RENAME(LFN,NFN)
      CALL LOADER 
      CALL PULL(IRD)
      IF(LTY(IRD).EQ.0) CALL ERROR(29)
C     GOTO 902
C 
C  REDRAW DISPLAY 
C 
902   CALL FREDIS(IRT,IRD)
      LXM(IRD)=KXM
      LYM(IRD)=KYM
      LXX(IRD)=KXX
      LYX(IRD)=KYX
      CALL DRAW(IRD)
      RETURN
C 
      END 
